---
jupytext:
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.11.5
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Exercise set F

Please, see the 
[**general comment on the tutorial exercises**](02.exercises.A.md)

## Question F.1

Consider a function $f : \mathbb{R}^N \ni {\bf x} \mapsto {\bf x}'B{\bf x} \in \mathbb{R}$, where $N \times N$ matrix $B$ is square but not symmetric.
Show that the same function can be represented as ${\bf x}'A{\bf x}$ where $A$ is symmetric.

```{hint}
Recall that the definition of a quadratic form calls for the symmetry of matrix $A$. This exercise shows that this assumption is without loss of generality.
```

```{hint}
Given a square matrix $M$, you can use the identity $M = \tfrac{1}{2}(M+M') + \tfrac{1}{2}(M-M')$ where the first component is symmetric and the second is not symmetric.
```

## Question F.2

Consider a quadratic form $f : \mathbb{R}^N \ni {\bf x} \mapsto {\bf x}'A{\bf x} \in \mathbb{R}$, where $N \times N$ matrix $A$ is symmetric.

Using the product rule of multivariate calculus, derive the gradient and Hessian of $f$. Make sure that all multiplied vectors and matrices are conformable.

```{hint}
You can assume that ${\bf x}$ is a column vector, and that any vector function of ${\bf x}$ is also a column vector.
```

## Question F.3

This exercise takes you on a tour of a binary logit model and its properties.

Consider a model when a decision maker is making a choice between $J=2$ two alternatives, each of which has a pair of characteristic $x_j \in \mathbb{R}^2$, $j=1,2$. Econometrician observes data on these characteristics and the choice made by the decision maker $y_i \in \{0,1\}$, where $y_i = 1$ denotes that the first alternative was chosen. The data is indexed with $i$ and has $N$ observations, i.e. $i \in \{1,\dots,N\}$.

To rationalize the data the econometrician assumes that the utility of each alternative is given by a scalar product of a vector of parameters $\beta \in \mathbb{R}^2$ and a vector function $h \colon \mathbb{R}^2 \to \mathbb{R}^2$ of alternative and decision maker attributes. Let 
%
$$
h \colon
\left(
\begin{array}{c}
x \\ z
\end{array}
\right)
\mapsto 
\left(
\begin{array}{l}
x \\ xz
\end{array}
\right)
$$


In line with the random utility model, the econometrician also assumes that the utility of each alternative contains the additively separable random component which has an appropriately centered type I extreme value distribution, such that the choice probabilities for the two alternatives are given by a vector function $p \colon \mathbb{R}^2 \to (0,1) \subset \mathbb{R}^2$
In line with the random utility model, the econometrician also assumes that the utility of each alternative contains the additively separable random component which has an appropriately centered type I extreme value distribution, such that the choice probabilities for the two alternatives are given by a vector function $p \colon \mathbb{R}^2 \to (0,1) \subset \mathbb{R}^2$
%
$$
p \colon
\left(
\begin{array}{c}
u_1 \\ u_2
\end{array}
\right)
\mapsto 
\left(
\begin{array}{c}
\frac{\exp(u_1)}{\exp(u_1) + \exp(u_2)}\\
\frac{\exp(u_2)}{\exp(u_1) + \exp(u_2)}
\end{array}
\right)
$$

In order to estimate the vector of parameters of the model $\beta$, the econometrician maximizes the likelihood of observing the data $D = \big(\{x_j\}_{j \in \{1,2\}},\{z_i,y_i\}_{i \in \{1,\dots,N\}}\big)$. The log-likelihood function $logL \colon \mathbb{R}^{2+J+2N} \to \mathbb{R}$ is given by
%
$$
L(\beta,D) = \prod_{i=1}^N \ell_i(\beta,x,y_i),
$$
where the individual log-likelihood contribution is given by a scalar product function $\ell_i \colon \mathbb{R}^6 \to \mathbb{R}$
%
$$
\ell_i(\beta,x,y_i) = 
\left[p_1 \left(
\begin{array}{l}
\beta \cdot x_1 \\
\beta \cdot x_2
\end{array}
\right)\right]^{y_i}
\left[p_2 \left(
\begin{array}{l}
\beta \cdot x_1 \\
\beta \cdot x_2
\end{array}
\right)\right]^{1-y_i}
$$

Assignments:

1. Write down the optimization problem the econometrician is solving. Explain the meaning of each part.
    - What are the variables the econometrician has control over in the estimation exercise? 
    - What variables should be treated as parameters of the optimization problem?

2. Elaborate on whether the solution can be guaranteed to exist.
    - What theorem should be applied?
    - What conditions of the theorem are met?
    - What conditions of the theorem are not met?

3. Derive the gradient and Hessian of the log-likelihood function. Make sure that all multiplied vectors and matrices are conformable.

4. Derive conditions under which the likelihood function has a unique maximizer (and thus the logit model has a unique maximum likelihood estimator).

