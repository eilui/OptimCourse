---
jupytext:
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.11.5
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Solutions for the Exercise set A

## Question A.1

The point $x=0$ is indeed a maximizer, since $f(x) = 1 -|x| \leq 1 = f(0)$ for any $x \in [-1, 1]$ ($|x|=0$ if and only if $x=0$).
It is also a unique maximizer, since no other point is a maximizer (because $1 -|x| < 1$ for any other $x$).
It is an interior maximizer since $0$ is not an end point of $[-1, 1]$.
It is not stationary because $f$ is not differentiable at this point (sketch the graph if you like) and hence cannot satisfy $f'(x)=0$.

## Question A.2

The set $S$ of stationary points of $f$ are the points $x \in \mathbb{R}$ such
that $f'(x) = \cos(x) = 0$. By the definition of the cosine function this
is the set

$$
S := \{ x \in \mathbb{R} : x = \pi/2 + k \pi \text{ for } k \in \mathbb{Z} \}
$$

%
Every point in the domain $\mathbb{R}$ is interior (i.e, not an end point) and
the function $f$ is differentiable, so the set of maximizers will be
contained in the set of stationary points. The same is true of the set of
minimizers. From the definition of the sine function, we have
%

$$
f(\pi/2 + k \pi) =
\begin{cases}
    1 & \text{ if $k$ is even} \\
    -1 & \text{ if $k$ is odd} \\
\end{cases}
$$

Hence the set of maximizers is
%

$$
M^* := \{ x \in \mathbb{R} : x = \pi/2 + k \pi \text{ for  \} k \text{ an
even integer}}
$$

%
The set of minimizers is
%

$$
M_* := \{ x \in \mathbb{R} : x = \pi/2 + k \pi \text{ for  \} k \text{ an
odd integer}}
$$

## Question A.3

1. The formulation is not correct. The revenue (after reincerting constant $A$) is $p A k^{\alpha} \ell^{\beta}$, the costs are $w \ell + r k$, and the choice variables are $k$ and $\ell$ ($w$ and $r$ are not chosen by the firm).  
   The constraint $\alpha + \beta < 1$ is irrelevant for the optimization problem, instead it is a constraint on the parameters for the problem to be well posed.
   Relevant constraints on the optimization problem are $k>0$ and $\ell>0$, they can be first ignored and checked after we solve the unconstrained version of the problem.

2. The correct formulation is ($A, p, \alpha, \beta, w, r$ are parameters and should be fixed/found out before the firm solves the optimization problem)
   %

   $$
   p A k^{\alpha} \ell^{\beta} - w \ell - r k
   \rightarrow \max_{k, \ell}\\
   \quad \mathrm{s.t.} \quad
   k \ge 0, \ell \ge 0
   $$

   %

3. See lecture notes
4. See lecture notes
5. Optimal strategy $k^*, \ell^*$ are given in the lecture notes. The maximizer is unique because the objective function is strictly concave when $\alpha+\beta < 1$.
   Proof:
   We check second order conditions for strict concavity.

   What we need: for any $k, \ell > 0$

   1. $\pi_{11}(k, \ell) < 0$
   2. $\pi_{11}(k, \ell) \, \pi_{22}(k, \ell) >  \pi_{12}(k, \ell)^2$roof: _coming next_

   The second order derivatives are

   $$
   \pi_{11}(k,\ell) = (\alpha-1)\alpha pA k^{\alpha-2} \ell^\beta \\
   \pi_{22}(k,\ell) = (\beta-1)\beta pA k^{\alpha} \ell^{\beta-2}\\
   \pi_{12}(k, \ell) = \alpha \beta pA k^{\alpha-1} \ell^{\beta-1}.
   $$

   Since $\alpha+\beta<1$ and $\alpha, \beta \geq 0$, we have $\alpha-1<0$, which implies $\pi_{11}(k,\ell)<0$ for all $k, \ell >0$.  
   Moreover, the second order differentials imply

   $$
   \pi_{11}(k, \ell) \, \pi_{22}(k, \ell) = (\alpha-1)(\beta-1)\alpha \beta p^2 A^2 k^{2\alpha-2} \ell^{2\beta-2}\\
   (\pi_{22}(k, \ell))^2 = \alpha^2 \beta^2 p^2 A^2 k^{2\alpha-2} \ell^{2\beta-2}.
   $$

   Assuming that all parameters and variables are positive.
   Then, we obtain $\pi_{11}(k, \ell) \, \pi_{22}(k, \ell) >  \pi_{12}(k, \ell)^2$ if and only if $(\alpha-1)(\beta-1) > \alpha \beta$ if and only if $1 > \alpha + \beta$.

## Question A.4

The graph of $f(x,y)$ is

```{code-cell} python
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d.axes3d import Axes3D
import numpy as np
import scipy as sp
from matplotlib import cm
f = lambda x, y: np.cos(x**2 + y**2) / (1 + x**2 + y**2)
xgrid = np.linspace(-3, 3, 50)
ygrid = xgrid
x, y = np.meshgrid(xgrid, ygrid)
fig = plt.figure(figsize=(8, 6))
ax = fig.add_subplot(111, projection='3d')
ax.plot_surface(x,
                y,
                f(x, y),
                rstride=2, cstride=2,
                cmap=cm.jet,
                alpha=0.7,
                linewidth=0.25)
ax.set_zlim(-0.5, 1.0)
plt.show()
```

Let $t = x^2+y^2 \geq 0$.
The function becomes $$f(x,y) = \frac{\cos(x^2+y^2)}{1 + x^2+y^2} = \frac{\cos(t)}{1 + t} =: g(t)  \quad (t \geq 0) .$$
First note that since $t \geq 0$ and $\cos(t) \leq 1$, we have $g(t)\leq 1$ and $g(0)=1$.
Hence, $t=0$ is a maximizer for $g$, or $(x,y)=(0,0)$ is the maximizer for $f$.
It is a unique maximizer, since if $g(t) < 1$ for $t >0$.

Next, we find the stationary points of $f$ by finding the stationary points of $g$.
The FOC is

$$g'(t) = \frac{-\sin(t)(1+t) - \cos(t)}{(1+t)^2} = 0.$$

Since $(1+t)^2>0$, it must be

$$-\sin(t)(1+t) - \cos(t) = 0 ⇔ t\sin(t) + \sin(t) + \cos(t)=0.$$

The numerical solutions for the smallest stationary point $t_m$ such that $\cos(t_m)<0$ are

```{code-cell} python3
g = lambda t: np.cos(t) / (1+t)
gp = lambda t: t * np.sin(t) + np.sin(t) + np.cos(t)
xgrid = np.linspace(0, 10, 200)
fig = plt.figure(figsize=(8, 6))
plt.plot(xgrid, gp(xgrid))
plt.hlines(y=0, xmin=0, xmax=10)
plt.show()

res = sp.optimize.root_scalar(gp, bracket=[2, 4], method='brentq')
print("The smallest stationary point is tm= ", res.root)
print("The minimum is ", g(res.root))
```

The minimizers are $\{(x,y)\in\mathbb{R}: x^2+y^2 = t_m\}$.
To verify that $t_m$ is the unique minimizer for $g$, since $\cos^2(t) + \sin^2(t)=1$, we rewrite FOC to get

$$
t\sin(t) + \sin(t) = \pm \sqrt{1-\sin^2(t)} \\
⇔ \sin^2(t) = \frac{1}{2 + 2t + t^2} \\
⇔ \cos^2(t) = 1 - \frac{1}{2+2t + t^2}=\frac{(1+t)^2}{2+2t + t^2}\\
⇒ g(t) = \frac{\cos(t)}{1+t} = \pm \frac{1}{\sqrt{2+2t +t^2}}  \qquad (\text{$t$ is stationary point}).$$

Therefore, the smallest stationary point such that $\cos(t) < 0$ will be the unique minimizer for $g$.
$$
